# Transport-company-application
## База данных
![](https://github.com/NovozhilovAY/Pictures-and-Gifs-for-readme/blob/main/Transport%20company%20application/схема1.PNG)
![](https://github.com/NovozhilovAY/Pictures-and-Gifs-for-readme/blob/main/Transport%20company%20application/Схема2.PNG)


В таблице log будет отображатся каждое изменение координат автомобиля


Таблица history будет заполняться перед очисткой таблицы log и будет содержать статистику за более широкий промежеток времени.

### Функции и триггеры

* get_distance(lat1 numeric,
	long1 numeric,
	lat2 numeric,
	long2 numeric)
  
  
Возвращает расстояние между двумя географическими координатами.

* insert_car()

Триггерная функция, срабатывает при добавлении нового автомобиля в таблицу cars. При срабатывании добавляется начальная запись об автомобиле в таблицу log.

* update_position()

Триггерная функция, срабатывает при обновлении координат автомобиля. При срабатывании высчитывается пройденное расстояние, в таблицу log заносится информация о новых координатах, и пройденном расстоянии, в таблице cars у соответствующей записи изменяются координаты, увеличивается общий пробег и уменьшается пробег до технического обслуживания.

* clear_log()

Вносит в таблицу history пробег каждого автомобиля за сутки. Очищает таблицу log. Вносит в таблицу log начальные записи о всех автомобилях.
